[[file:10_languages.md][â† å‰ã®ç« ã¸]] | [[file:00_introduction.md][ç›®æ¬¡ã«æˆ»ã‚‹]] | [[file:12_orgmode.md][æ¬¡ã®ç« ã¸ â†’]]

---

# ç¬¬10ç« ï¼šãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ç·¨ - ç©¶æ¥µã®é«˜é€ŸåŒ–

[[file:10_languages.md][â† å‰ã®ç« ã¸]] | [[file:00_introduction.md][ç›®æ¬¡ã«æˆ»ã‚‹]] | [[file:12_orgmode.md][æ¬¡ã®ç« ã¸ â†’]]

---

## ã“ã®ç« ã®ç›®æ¨™
- èµ·å‹•æ™‚é–“ã®å¾¹åº•çš„ãªé«˜é€ŸåŒ–ï¼ˆ0.3ç§’ã‚’ç›®æŒ‡ã™ï¼‰
- ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®æœ€é©åŒ–ã¨ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°
- é…å»¶èª­ã¿è¾¼ã¿ã®å®Œå…¨ãƒã‚¹ã‚¿ãƒ¼
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬ã¨ç¶™ç¶šçš„æ”¹å–„

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„ã‚°ãƒ©ãƒ•

```
èµ·å‹•æ™‚é–“ã®æœ€é©åŒ–çµæœ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

åˆæœŸçŠ¶æ…‹    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 3.2ç§’

Step 1      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 2.0ç§’
GCæœ€é©åŒ–    â–¼ 37.5% å‰Šæ¸›

Step 2      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 1.2ç§’
é…å»¶èª­è¾¼    â–¼ 40% å‰Šæ¸›

Step 3      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 0.6ç§’
Nativeï½ºï¾ï¾Šï¾Ÿï½²ï¾™ â–¼ 50% å‰Šæ¸›

æœ€çµ‚çµæœ    â–ˆâ–ˆâ–ˆ 0.3ç§’ ğŸš€
            â–¼ 90.6% å‰Šæ¸›ï¼

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

## ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®æ¨ç§»

```
ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ (MB)
    â†‘
200 â”‚     â•­â”€â•®
    â”‚    â•±   â•²    GCMHã«ã‚ˆã‚‹
150 â”‚   â•±     â•²   ã‚¹ãƒãƒ¼ãƒˆGC
    â”‚  â•±       â•²
100 â”‚ â•±         â•²_______________
    â”‚â•±                å®‰å®šç¨¼åƒ
 50 â”‚
    â”‚
  0 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’
    èµ·å‹•  1åˆ†   5åˆ†   10åˆ†   æ™‚é–“

é€šå¸¸ã®Emacs: å¸¸ã«é«˜ã„ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
GCMHä½¿ç”¨æ™‚: ã‚¢ã‚¤ãƒ‰ãƒ«æ™‚ã«è‡ªå‹•çš„ã«GCå®Ÿè¡Œ
```

## ç¬¬10ç« ã®è¨­å®šï¼šãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### GCMHï¼ˆGarbage Collector Magic Hackï¼‰
```emacs-lisp
;; GCMHã§è³¢ã„ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†
(use-package gcmh
  :ensure t
  :diminish
  :init
  ;; åˆæœŸå€¤ã‚’é«˜ã‚ã«è¨­å®š
  (setq gcmh-idle-delay 5
        gcmh-high-cons-threshold (* 16 1024 1024)  ; 16MB
        gcmh-verbose nil)
  :config
  (gcmh-mode 1))
```

### é…å»¶èª­ã¿è¾¼ã¿æˆ¦ç•¥
```emacs-lisp
;; use-packageã®ã‚°ãƒ­ãƒ¼ãƒãƒ«è¨­å®š
(setq use-package-always-defer t
      use-package-always-ensure t
      use-package-expand-minimally t
      use-package-compute-statistics t)  ; çµ±è¨ˆæƒ…å ±ã‚’åé›†

;; é‡ã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®é…å»¶èª­ã¿è¾¼ã¿ä¾‹
;; â€»ã“ã‚Œã‚‰ã¯è¨­å®šä¾‹ã§ã™ï¼ˆå®Ÿéš›ã®è¨­å®šã¯å„ç« å‚ç…§ï¼‰
(use-package magit
  :defer t
  :commands (magit-status magit-clone)
  :bind ("C-x g" . magit-status))

(use-package treemacs
  :defer t
  :commands treemacs)

(use-package lsp-mode
  :defer t
  :commands (lsp lsp-deferred))

;; ã‚¢ã‚¤ãƒ‰ãƒ«æ™‚ã«èª­ã¿è¾¼ã‚€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
(use-package yasnippet
  :defer 5  ; 5ç§’å¾Œã«èª­ã¿è¾¼ã¿
  :config
  (yas-global-mode 1))
```

### ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ãƒ„ãƒ¼ãƒ«
```emacs-lisp
;; esupã«ã‚ˆã‚‹èµ·å‹•æ™‚é–“ã®è©³ç´°åˆ†æ
(use-package esup
  :ensure t
  :defer t
  :commands esup)

;; ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯é–¢æ•°
(defun my/benchmark-init ()
  "Benchmark Emacs startup."
  (interactive)
  (message "Benchmarking...")
  (esup))

;; use-packageçµ±è¨ˆè¡¨ç¤º
(defun my/show-package-stats ()
  "Show use-package statistics."
  (interactive)
  (use-package-report))

;; ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡è¡¨ç¤º
(defun my/memory-usage ()
  "Show current memory usage."
  (interactive)
  (message "Memory usage: %.2f MB"
           (/ (float (memory-info)) 1024 1024)))
```

### ãƒ•ã‚¡ã‚¤ãƒ«ã®é…å»¶èª­ã¿è¾¼ã¿
```emacs-lisp
;; å¤§ããªãƒ•ã‚¡ã‚¤ãƒ«ã®è­¦å‘Šé–¾å€¤
(setq large-file-warning-threshold (* 100 1024 1024))  ; 100MB

;; so-longãƒ¢ãƒ¼ãƒ‰ã§é•·ã„è¡Œã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æœ€é©åŒ–
(global-so-long-mode 1)

;; ãƒ•ã‚¡ã‚¤ãƒ«ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°ã®å‡¦ç†ã‚’é«˜é€ŸåŒ–
(setq enable-local-variables :safe)
```

### ãƒ—ãƒ­ã‚»ã‚¹ã¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®æœ€é©åŒ–
```emacs-lisp
;; ãƒ—ãƒ­ã‚»ã‚¹å‡ºåŠ›ã®èª­ã¿è¾¼ã¿ãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚º
(setq read-process-output-max (* 3 1024 1024))  ; 3MB

;; LSPã®æœ€é©åŒ–
(with-eval-after-load 'lsp-mode
  (setq lsp-idle-delay 0.5
        lsp-log-io nil
        lsp-completion-provider :none
        lsp-prefer-flymake nil))
```

### ãƒ•ã‚©ãƒ³ãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœ€é©åŒ–
```emacs-lisp
;; ãƒ•ã‚©ãƒ³ãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®åœ§ç¸®ã‚’ç„¡åŠ¹åŒ–
(setq inhibit-compacting-font-caches t)

;; Unicodeæ–‡å­—ã®ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã‚’æœ€é©åŒ–
(set-fontset-font t 'unicode
                   (font-spec :family "Noto Sans CJK JP")
                   nil 'prepend)
```

### èµ·å‹•æ™‚é–“æ¸¬å®šã®é«˜åº¦åŒ–
```emacs-lisp
;; è©³ç´°ãªèµ·å‹•æ™‚é–“ãƒ¬ãƒãƒ¼ãƒˆ
(add-hook 'emacs-startup-hook
          (lambda ()
            (let* ((startup-time (float-time
                                 (time-subtract after-init-time
                                               before-init-time)))
                   (gc-time (float-time
                            (time-subtract gc-elapsed
                                         (seconds-to-time 0)))))
              (message "=====================================")
              (message " Emacs loaded in %.3f seconds" startup-time)
              (message " with %d garbage collections taking %.3f seconds"
                      gcs-done gc-time)
              (message " %.1f%% of startup time was spent in GC"
                      (* 100 (/ gc-time startup-time)))
              (when (< startup-time 0.5)
                (message " ğŸš€ Blazing fast startup achieved!"))
              (message "====================================="))))

;; ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚é–“ã®è¿½è·¡
(defun my/time-package-loads ()
  "Time how long each package takes to load."
  (interactive)
  (require 'benchmark)
  (message "Package load times:")
  (dolist (feature features)
    (when (string-match "^[^/]+$" (symbol-name feature))
      (let ((time (benchmark-elapse (require feature))))
        (when (> time 0.01)
          (message "  %s: %.3fs" feature time))))))
```

### ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒãƒ³ãƒ‰
```emacs-lisp
(with-eval-after-load 'general
  (general-def
    :states '(normal visual)
    :prefix "SPC h"
    "b" '(my/benchmark-init :which-key "benchmark startup")
    "p" '(my/show-package-stats :which-key "package stats")
    "m" '(my/memory-usage :which-key "memory usage")
    "t" '(my/time-package-loads :which-key "time packages")))
```

### ã“ã®ç« ã§å¾—ã‚‰ã‚ŒãŸã‚‚ã®
- âœ… èµ·å‹•æ™‚é–“0.5ç§’ä»¥å†…ã®è¶…é«˜é€ŸEmacs
- âœ… GCMHã«ã‚ˆã‚‹è³¢ã„ãƒ¡ãƒ¢ãƒªç®¡ç†
- âœ… è©³ç´°ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬ãƒ„ãƒ¼ãƒ«
- âœ… use-packageçµ±è¨ˆã«ã‚ˆã‚‹æœ€é©åŒ–ã®å¯è¦–åŒ–
- âœ… å¤§è¦æ¨¡ãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚‚å¿«é©ãªå‹•ä½œ
- âœ… LSPã‚„ãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©åŒ–è¨­å®š
- âœ… ç¶™ç¶šçš„ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„ã®åŸºç›¤

---

[[file:10_languages.md][â† å‰ã®ç« ã¸]] | [[file:00_introduction.md][ç›®æ¬¡ã«æˆ»ã‚‹]] | [[file:12_orgmode.md][æ¬¡ã®ç« ã¸ â†’]]